<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN'
	'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap>

	<typeAlias alias="air" type="item.air.AirVO" />
	<!-- 리절트 맵 정의 -->
	<resultMap id="boardair" class="air">
		<result property="no" column="no" />
		<result property="arv" column="arv" />
		<result property="dep" column="dep" />
		<result property="price" column="price" />
		<result property="content" column="content" />
		<result property="image1" column="image1" />
		<result property="seat" column="seat" />
		<result property="seat_grade" column="seat_grade" />
		<result property="ad" column="ad" />
		<result property="dd" column="dd" />
		<result property="air_company" column="air_company" />
		<result property="grade" column="grade" />
	</resultMap>

	<!-- 공통으로 사용할 select 정의 -->
	<select id="select-allA" resultMap="boardair">
		select * from air
	</select>	
	
	<!-- 일반 검색 -->
	<select id="listAir" resultMap="boardair" parameterClass="air">
		<!-- ad날짜만 계산 -->
		SELECT * from air WHERE arv=#arv# and seat>=#seat# 
				and seat_grade=#seat_grade# and ad>=#ad#
	</select>
	
	<!-- 가격 낮은 순 -->
	<select id="listAir_lowprice" resultMap="boardair" parameterClass="air">
		SELECT * from air WHERE arv=#arv# and ad>=#ad# and 
				seat>=#seat# and seat_grade=#seat_grade# order by price asc
	</select>
	
	<!-- 출발시간 빠른 순 -->
	<select id="listAir_ad_time" resultMap="boardair" parameterClass="air">
		SELECT * from air WHERE arv=#arv# and ad>=#ad# and 
				seat>=#seat# and seat_grade=#seat_grade# order by ad asc
	</select>

	<!-- 도착시간 빠른 순 -->
	<select id="listAir_dd_time" resultMap="boardair" parameterClass="air">
		SELECT * from air WHERE arv=#arv# and ad>=#ad# and 
				seat>=#seat# and seat_grade=#seat_grade# order by dd asc
	</select>
	
	<!-- 검색 테슽 -->
	<select id="listAir_search" resultMap="boardair" parameterClass="java.util.Map">
		SELECT * from air WHERE arv=#arv# and ad>=to_date(#ad#,'yyyy-MM-dd') and 
				seat>=#seat# and seat_grade=#seat_grade#
				<isEqual property="ckAD_1" compareValue="06">
					 <!-- and ad between to_date('2019-02-01 08:00:00','yyyy-MM-dd HH24:MI:SS') and to_date('2019-02-01 09:00:00','yyyy-MM-dd HH24:MI:SS') -->
					 and air_company='대한항공'
				</isEqual>
				<isEqual property="ckAD_2" compareValue="12">
				
				</isEqual>
				<isEqual property="ckAD_3" compareValue="18">
				
				</isEqual>
				<isEqual property="ckAD_4" compareValue="24">
				
				</isEqual>
				
				<isEqual property="ckDD_1" compareValue="06">
				
				</isEqual>
				<isEqual property="ckDD_1" compareValue="12">
				
				</isEqual>
				<isEqual property="ckDD_1" compareValue="18">
				
				</isEqual>
				<isEqual property="ckDD_1" compareValue="24">
				
				</isEqual>
				
				<isEqual property="air_company_korea" compareValue="korea">
					and air_company='대한항공'
				</isEqual>
				<isEqual property="air_company_asia" compareValue="asia">
					and air_company='아시아나'
				</isEqual>
				<isEqual property="air_company_jin" compareValue="jin">
					and air_company='진에어'
				</isEqual>
				

	</select>
</sqlMap>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN'
	'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap>

	<typeAlias alias="hotel" type="item.hotel.HotelVO" />
	<!-- 리절트 맵 정의 -->
	<resultMap id="boardhotel" class="hotel">
		<result property="no" column="no" />
		<result property="name" column="name" />
		<result property="price" column="price" />
		<result property="content" column="content" />
		<result property="country" column="country" />
		<result property="region" column="region" />
		<result property="readcount" column="readcount" />
		<result property="image1" column="image1" />
		<result property="image2" column="image2" />
		<result property="image3" column="image3" />
		<result property="reg_date" column="reg_date" />
		<result property="tel" column="tel" />
		<result property="checkin" column="checkin" />
		<result property="checkout" column="checkout" />
		<result property="maxnum" column="maxnum" />
		<result property="grade" column="grade" />
	</resultMap>
	
	<!-- 공통으로 사용할 select 절 정의 -->
		<sql id="select-allH">
			SELECT * FROM HOTEL 
		</sql>
		
		<!-- 공통으로 사용할 where-no 절 정의 -->
		<sql id="where-noH">
			WHERE no = #no#
		</sql>
	
		<!-- select 쿼리문 정의 -->
		<select id="selectAllH" resultMap="hotelRes">
			<include refid="select-allH" />
			ORDER BY no DESC
		</select>
		
		<select id="selectOneH" resultMap="hotelRes" parameterClass="int">
			<include refid="select-allH" />
			<include refid="where-noH" />
		</select>
		
		<select id="selectLastNoH" resultClass="hotel">
			SELECT max(no) as no FROM HOTEL
		</select>		


	<!-- 검색어 없을 때 (정렬만 헀을 때도 포함) 
	<select id="listhotel" resultMap="boardhotel" parameterClass="hotel">
		SELECT * from hotelvo WHERE region like '%'||#searchn#||'%' ORDER BY
		region DESC, reg_date DESC
	</select>

	 정렬 후에 검색할 때 
	<select id="searchhotel" resultMap="boardhotel" parameterClass="hotel">
		SELECT * FROM (SELECT * FROM hotelvo where region like
		'%'||#searchn#||'%' and people > #people# and room > #room#) where name like '%'||#search#||'%' or content
		like '%'||#search#||'%'
		or region like '%'||#search#||'%' ORDER BY
		reg_date DESC
	</select>
    -->

</sqlMap>